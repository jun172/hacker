<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>XSS ãƒ•ã‚©ãƒ¼ãƒ æ”»æ’ƒãƒ‡ãƒ¢</title>

<style>
/* ===== å…¨ä½“ ===== */
body {
  margin: 0;
  padding: 0;
  font-family: "Courier New", monospace;
  background: #050505;
  color: #00ff9c;
}

/* ===== ãƒ˜ãƒƒãƒ€ãƒ¼ ===== */
header {
  background: linear-gradient(90deg, #0a0a0a, #001f14);
  border-bottom: 2px solid #00ff9c;
  padding: 20px;
  text-align: center;
}

header h1 {
  margin: 0;
  color: #ff5252;
  text-shadow: 0 0 8px #ff1744;
}

header p {
  font-size: 14px;
  color: #8affc1;
}

/* ===== ãƒ¡ã‚¤ãƒ³ ===== */
main {
  max-width: 900px;
  margin: 40px auto;
  padding: 0 20px;
}

/* ===== èª¬æ˜ãƒ–ãƒ­ãƒƒã‚¯ ===== */
.explain {
  background: #020202;
  border: 1px solid #00ff9c;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 30px;
  box-shadow: 0 0 20px rgba(0,255,156,0.25);
}

.explain h2 {
  color: #ffca28;
  margin-top: 0;
}

.explain ul {
  padding-left: 20px;
}

.explain li {
  margin-bottom: 8px;
}

/* ===== æƒ…å ±ãƒ–ãƒ­ãƒƒã‚¯ ===== */
.info {
  background: #0d1f17;
  border-left: 6px solid #ffca28;
  padding: 16px;
  margin-bottom: 25px;
  box-shadow: 0 0 15px rgba(255,202,40,0.2);
}

/* ===== ã‚«ãƒ¼ãƒ‰ ===== */
.card {
  background: #020202;
  border: 1px solid #00ff9c;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 0 20px rgba(0,255,156,0.25);
}

/* ===== ãƒ•ã‚©ãƒ¼ãƒ  ===== */
form {
  display: flex;
  gap: 10px;
}

input {
  flex: 1;
  background: black;
  color: #00ff9c;
  border: 1px solid #00ff9c;
  padding: 10px;
  border-radius: 4px;
  font-family: inherit;
}

button {
  background: #00ff9c;
  color: black;
  border: none;
  padding: 10px 18px;
  font-weight: bold;
  border-radius: 4px;
  cursor: pointer;
}

button:hover {
  background: #1affad;
}

/* ===== å‡ºåŠ›ã‚¨ãƒªã‚¢ ===== */
#posts {
  margin-top: 30px;
  background: black;
  border: 1px solid #ff5252;
  padding: 20px;
  min-height: 60px;
  box-shadow: 0 0 25px rgba(255,82,82,0.35);
  animation: alertGlow 1.5s infinite alternate;
}

@keyframes alertGlow {
  from { box-shadow: 0 0 10px rgba(255,82,82,0.3); }
  to   { box-shadow: 0 0 30px rgba(255,82,82,0.8); }
}

code {
  color: #ffca28;
}
body {
  margin: 0;
  padding: 0;
  background: #050505;
  color: #00ff9c;
  font-family: "Courier New", monospace;
  line-height: 1.7;
}

header {
  background: linear-gradient(90deg, #0a0a0a, #001f14);
  border-bottom: 2px solid #00ff9c;
  padding: 24px;
  text-align: center;
}

header h1 {
  margin: 0;
  color: #1affad;
}

main {
  max-width: 900px;
  margin: 40px auto;
  padding: 0 20px;
}

.section {
  background: #020202;
  border: 1px solid #00ff9c;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 30px;
  box-shadow: 0 0 20px rgba(0,255,156,0.25);
}

.section h2 {
  margin-top: 0;
  color: #ffca28;
}

.alert {
  background: #140000;
  border-left: 6px solid #ff5252;
  padding: 15px;
  margin-bottom: 20px;
}

.safe {
  background: #001f14;
  border-left: 6px solid #00ff9c;
  padding: 15px;
  margin-bottom: 20px;
}

pre {
  background: black;
  color: #8affc1;
  padding: 15px;
  overflow-x: auto;
  border: 1px solid #333;
}

code {
  color: #ffca28;
}

footer {
  text-align: center;
  font-size: 12px;
  color: #4dffb5;
  padding: 20px;
  border-top: 1px solid #00ff9c;
}
</style>
</head>

<body>

<header>
  <h1>âš  XSS æ”»æ’ƒãƒ‡ãƒ¢</h1>
  <p>DOMå‹XSS / ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã®å±é™ºæ€§</p>
</header>

<main>

<!-- ===== XSS èª¬æ˜ ===== -->
<div class="explain">
  <h2>ğŸ” XSSï¼ˆCross-Site Scriptingï¼‰ã¨ã¯</h2>
  <p>
    XSSã¨ã¯ã€<b>æ”»æ’ƒè€…ãŒå…¥åŠ›ã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒ</b><br>
    <b>æ­£è¦ã‚µã‚¤ãƒˆã®æ¨©é™ã§å®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã†è„†å¼±æ€§</b>ã§ã™ã€‚
  </p>

  <h2>ğŸ§  ã“ã®ãƒšãƒ¼ã‚¸ã§èµ·ãã¦ã„ã‚‹ã“ã¨</h2>
  <ul>
    <li>ã“ã®ãƒ‡ãƒ¢ã¯ <b>DOMå‹XSS</b></li>
    <li>ã‚µãƒ¼ãƒãƒ¼ï¼ˆPHPãªã©ï¼‰ã¯ä½¿ç”¨ã—ã¦ã„ãªã„</li>
    <li>JavaScriptãŒç›´æ¥HTMLã‚’æ›¸ãæ›ãˆã¦ã„ã‚‹</li>
  </ul>

  <h2>âš™ æŠ€è¡“ã”ã¨ã®å½¹å‰²</h2>
  <ul>
    <li><b>HTML</b>ï¼šæ”»æ’ƒã‚³ãƒ¼ãƒ‰ã®å…¥å£</li>
    <li><b>JavaScript</b>ï¼šæ”»æ’ƒã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ</li>
    <li><b>PHP</b>ï¼šå®Ÿéš›ã®ã‚µã‚¤ãƒˆã§ã¯è¡¨ç¤ºæ™‚ã«XSSã‚’ç™ºç”Ÿã•ã›ã‚‹åŸå› </li>
  </ul>

  <h2>ğŸª CookieãŒç›—ã¾ã‚Œã‚‹ç†ç”±</h2>
  <p>
    XSSãŒæˆåŠŸã™ã‚‹ã¨ã€æ”»æ’ƒè€…ã®JavaScriptã¯<br>
    <b>document.cookie</b> ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚<br>
    HttpOnlyãŒç„¡ã„Cookieã¯ç›—ã¾ã‚Œã€<br>
    <b>ãƒ­ã‚°ã‚¤ãƒ³ãªã‚Šã™ã¾ã—</b>ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
  </p>
</div>

<!-- ===== æ³¨æ„ ===== -->
<div class="info">
  <b>âš  å±é™ºï¼š</b><br>
  å…¥åŠ›å†…å®¹ãŒãã®ã¾ã¾ <b>HTMLã¨ã—ã¦å®Ÿè¡Œ</b> ã•ã‚Œã¾ã™ã€‚<br>
  ä¾‹ï¼š<code>&lt;img src=x onerror=alert(document.cookie)&gt;</code>
</div>

<!-- ===== ãƒ‡ãƒ¢ ===== -->
<div class="card">
  <form id="form">
    <input type="text" id="msg" placeholder="æ”»æ’ƒã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
    <button>EXECUTE</button>
  </form>
</div>

<div id="posts">
  <!-- ã“ã“ã«æ”»æ’ƒçµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
</div>

</main>
<header>
  <h1>ğŸ” XSS å¯¾ç­–ã‚³ãƒ¼ãƒ‰è§£èª¬</h1>
  <p>ã€Œãªãœå®‰å…¨ãªã®ã‹ã€ã‚’ã‚³ãƒ¼ãƒ‰ã§ç†è§£ã™ã‚‹</p>
</header>

<main>

<!-- ===================== -->
<div class="section">
  <h2>â‘  JavaScriptï¼ˆDOMå‹XSSå¯¾ç­–ï¼‰</h2>

  <div class="alert">
    âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’ HTML ã¨ã—ã¦å®Ÿè¡Œ
  </div>

  <pre><code>
// DOMå‹XSSãŒç™ºç”Ÿã™ã‚‹åŸå› 
element.innerHTML = userInput;
  </code></pre>

  <p>
    <b>innerHTML</b> ã¯æ–‡å­—åˆ—ã‚’ HTML ã¨ã—ã¦è§£é‡ˆã™ã‚‹ãŸã‚ã€<br>
    &lt;script&gt; ã‚„ onerror å±æ€§ãŒå®Ÿè¡Œã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚
  </p>

  <div class="safe">
    âœ… å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ï¼šæ–‡å­—ã¨ã—ã¦è¡¨ç¤º
  </div>

  <pre><code>
// XSSå¯¾ç­–ï¼ˆæ¨å¥¨ï¼‰
element.textContent = userInput;
  </code></pre>

  <p>
    <b>textContent</b> ã¯ HTML ã‚’è§£é‡ˆã›ãšã€<br>
    ãŸã ã®æ–‡å­—åˆ—ã¨ã—ã¦å‡ºåŠ›ã—ã¾ã™ã€‚
  </p>
</div>

<!-- ===================== -->
<div class="section">
  <h2>â‘¡ PHPï¼ˆåå°„å‹ãƒ»ä¿å­˜å‹XSSå¯¾ç­–ï¼‰</h2>

  <div class="alert">
    âŒ å±é™ºãªPHPï¼šã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãªã—
  </div>

  <pre><code>
echo $_POST["msg"];
  </code></pre>

  <p>
    HTMLã‚¿ã‚°ãŒãã®ã¾ã¾å‡ºåŠ›ã•ã‚Œã€<br>
    JavaScriptãŒå®Ÿè¡Œã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
  </p>

  <div class="safe">
    âœ… å®‰å…¨ãªPHPï¼šHTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
  </div>

  <pre><code>
echo htmlspecialchars(
  $_POST["msg"],
  ENT_QUOTES,
  "UTF-8"
);
  </code></pre>

  <p>
    <b>&lt; &gt; " '</b> ã‚’ç„¡å®³åŒ–ã—ã€<br>
    HTMLã¨ã—ã¦è§£é‡ˆã•ã‚Œãªããªã‚Šã¾ã™ã€‚
  </p>
</div>

<!-- ===================== -->
<div class="section">
  <h2>â‘¢ Cookie ã‚’å®ˆã‚‹å¯¾ç­–</h2>

  <p>
    XSSã®æœ€çµ‚ç›®çš„ã¯ <b>ã‚»ãƒƒã‚·ãƒ§ãƒ³Cookieã®çªƒå–</b> ã§ã™ã€‚
  </p>

  <div class="safe">
    âœ… Cookieé˜²å¾¡è¨­å®šï¼ˆPHPï¼‰
  </div>

  <pre><code>
setcookie("session_id", $id, [
  "httponly" => true,
  "secure" => true,
  "samesite" => "Strict"
]);
  </code></pre>

  <ul>
    <li><b>HttpOnly</b>ï¼šJavaScriptã‹ã‚‰å–å¾—ä¸å¯</li>
    <li><b>Secure</b>ï¼šHTTPSé€šä¿¡é™å®š</li>
    <li><b>SameSite</b>ï¼šCSRFå¯¾ç­–</li>
  </ul>
</div>

<!-- ===================== -->
<div class="section">
  <h2>â‘£ CSPï¼ˆæœ€çµ‚é˜²è¡›ãƒ©ã‚¤ãƒ³ï¼‰</h2>

  <p>
    CSPã¯ã€Œã©ã®JavaScriptã‚’å®Ÿè¡Œã—ã¦ã‚ˆã„ã‹ã€ã‚’<br>
    ãƒ–ãƒ©ã‚¦ã‚¶ã«æŒ‡ç¤ºã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚
  </p>

  <pre><code>
Content-Security-Policy:
script-src 'self';
  </code></pre>

  <p>
    ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„<br>
    å¤–éƒ¨ã®æ‚ªæ„ã‚ã‚‹JSã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚
  </p>
</div>

<!-- ===================== -->
<div class="section">
  <h2>â‘¤ å¯¾ç­–ã¾ã¨ã‚</h2>

  <pre><code>
âœ” innerHTML ã‚’ä½¿ã‚ãªã„
âœ” textContent ã‚’ä½¿ã†
âœ” PHPã§ htmlspecialchars()
âœ” Cookieã« HttpOnly
âœ” CSP ã‚’è¨­å®š
  </code></pre>

  <p>
    XSSå¯¾ç­–ã¯ <b>1ã¤ã§ã¯ä¸ååˆ†</b>ã€‚<br>
    è¤‡æ•°ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§é˜²å¾¡ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
  </p>
</div>

</main>

<footer>
  XSSå¯¾ç­–ã¨ã¯ã€Œå®Ÿè¡Œã•ã›ãªã„ãƒ»ç›—ã‚‰ã›ãªã„ãƒ»å…¥ã‚Œã•ã›ãªã„ã€
</footer>

<script>
document.getElementById("form").addEventListener("submit", function(e) {
  e.preventDefault();

  const input = document.getElementById("msg").value;

  // âŒ DOMå‹XSSè„†å¼±ã‚³ãƒ¼ãƒ‰
  document.getElementById("posts").innerHTML = input;

  document.getElementById("msg").value = "";
});
</script>

</body>
</html>
