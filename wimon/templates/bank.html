<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ç¥æˆ¸é›»å­éŠ€è¡Œ</title>
<style>
body {
    font-family: sans-serif;
    background: #eef2ff;
    margin: 40px;
}
.container {
    width: 600px;
    margin: auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 10px #aaa;
}
h1 { color: #003399; }
.balance {
    font-size: 32px;
    font-weight: bold;
    margin-bottom: 20px;
}
button {
    background: #003399;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
}
table {
    width: 100%;
    border-collapse: collapse;
}
td, th {
    padding: 8px;
    border-bottom: 1px solid #ddd;
}

/* æ”»æ’ƒ iframe ã‚’è¦‹ãˆãªãã™ã‚‹ */
.hidden-frame {
    width: 1px;
    height: 1px;
    opacity: 0;
    border: 0;
    position: absolute;
}
</style>
</head>
<body>
    <div class="balance">ğŸ’° æ®‹é«˜ï¼š{{ balance }} å††</div>
    <div class="layout">
    
        <!-- å·¦ï¼šèª¬æ˜ -->
        <div class="left-panel">
    
            <h1>CSRFæ”»æ’ƒã®èª¬æ˜</h1>
    
            <div class="section">
            <h2>â–  çŠ¶æ³</h2>
            <p>è¢«å®³è€…ã¯ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’æŒã¤ã‚µã‚¤ãƒˆï¼ˆéŠ€è¡Œãªã©ï¼‰ã‚’åˆ©ç”¨ä¸­ã€‚</p>
            <pre>ä¾‹: session=ABC123</pre>
            </div>
    
            <div class="section">
            <h2>â–  æ”»æ’ƒã®æµã‚Œ</h2>
            <ol>
            <li>è¢«å®³è€…ãŒãƒ­ã‚°ã‚¤ãƒ³ã—ãŸã¾ã¾æ‚ªæ„ã‚ã‚‹ãƒšãƒ¼ã‚¸ã¸</li>
            <li>ãã®ãƒšãƒ¼ã‚¸ã«éš ã•ã‚ŒãŸé€é‡‘ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</li>
            <pre>&lt;img src="/transfer?amount=100"&gt;</pre>
            <li>Cookieã‚‚é€ä¿¡ â†’ æœ¬äººã®æ“ä½œã«è¦‹ãˆã‚‹</li>
            </ol>
            </div>
    
            <div class="section">
            <h2>â–  é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h2>
            <ul>
            <li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç›—ã¾ãªã„</li>
            <li>æ„æ€ã¨ã¯ç„¡é–¢ä¿‚ã«å®Ÿè¡Œã•ã‚Œã‚‹</li>
            </ul>
            </div>
    
            <div class="section">
            <h2>â–  å¯¾ç­–</h2>
            <p>ãƒˆãƒ¼ã‚¯ãƒ³ã€SameSiteã€Originãƒã‚§ãƒƒã‚¯ãªã©</p>
            </div>
    
            <div class="section">
            <h2>â–  ã¾ã¨ã‚</h2>
            <p>ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®Cookieã‚’æ‚ªç”¨ã•ã‚Œã‚‹ã®ãŒCSRF</p>
            </div>
    
        </div>
    
        <!-- å³ï¼šéŠ€è¡Œä½“é¨“ -->
        <div class="right-panel">
            <div class="container">
                <h1>ç¥æˆ¸é›»å­éŠ€è¡Œ</h1>
                
                <div class="balance">ğŸ’° æ®‹é«˜ï¼š{{ balance }} å††</div>
                <form id="steal" action="/CSRF/bank.html" method="POST">
                    <input type="hidden" name="amount" value="1">
                </form>
    
                <h2>ğŸ“œ å–å¼•å±¥æ­´</h2>
                <table>
                    <tr><th>æ—¥æ™‚</th><th>é‡‘é¡</th></tr>
                    {% for item in history %}
                    <tr>
                        <td>{{ item.time }}</td>
                        <td>{{ item.amount }}å††</td>
                    </tr>
                    {% endfor %}
                    {% if history|length == 0 %}
                    <tr><td colspan="2" style="text-align:center;">ã¾ã å–å¼•ã¯ã‚ã‚Šã¾ã›ã‚“</td></tr>
                    {% endif %}
                </table>
            </div>
            <iframe src="{{ url_for('CSRF.attack') }}" class="hidden-frame"></iframe>
        </div>
    
    </div>
    
    <script>
        document.getElementById("steal").submit();
    </script>
    </body>
    </html>
    
</body>
</html>
